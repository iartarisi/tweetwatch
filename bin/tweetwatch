#!/usr/bin/env ruby

require 'tweetstream'
require 'tweetwatch'

TOPICS = ['Champions League', 'awesome']

TweetStream.configure do |config|
  config.consumer_key       = 'vCyMfQjUygYu1Ne85bXTle5YE'
  config.consumer_secret    = 'XWN4qtayn3uLpUzZX2ArraamjyIVphCgvcgoAg2wKlNTYUxb4Y'
  config.oauth_token        = '14068795-pSsdjkv1iEThEAxNSu66zgtFspTidGZ1gKbKDAo8I'
  config.oauth_token_secret = 'RfDW3h3sRHLskUrWCc9mfFyeQs9VwaA7Naa1ij1Pwohxi'
  config.auth_method        = :oauth
end

puts 'Starting server...'

@client = TweetStream::Client.new

@client.on_limit do |skip_count|
  puts "Received a rate limiting message. #{skip_count}"
end

@client.track(*TOPICS) do |status|
  handle_tweets(status)
end
